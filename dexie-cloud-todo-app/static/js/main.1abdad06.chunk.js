(this["webpackJsonpdexie-cloud-todo-app"]=this["webpackJsonpdexie-cloud-todo-app"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){},108:function(e,t,n){},109:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(31),i=n.n(s),o=(n(92),n(13)),a=n(4),d=n(23),l=n(22),u=n(15),j=n(0);function b(e){var t=e.item,n=Object(o.usePermissions)(a.db,"todoItems",t);return Object(j.jsxs)("div",{className:"row "+(t.done?"done":""),children:[Object(j.jsx)("div",{className:"narrow",children:Object(j.jsx)("input",{type:"checkbox",disabled:!n.update("done"),checked:!!t.done,onChange:function(e){a.db.todoItems.update(t.id,{done:e.target.checked})}})}),Object(j.jsx)("div",{className:"todo-item-text",children:t.title}),Object(j.jsx)("div",{className:"todo-item-trash",children:Object(j.jsx)("button",{disabled:!n.delete(),onClick:function(){return a.db.todoItems.delete(t.id)},title:"Delete item",children:Object(j.jsx)(l.a,{icon:u.g})})})]})}var h=n(79);function m(e){var t=e.todoList,n=Object(r.useState)({title:""}),c=Object(d.a)(n,2),s=c[0],i=c[1];return Object(j.jsxs)("div",{className:"row add-item",children:[Object(j.jsx)("div",{className:"narrow",children:Object(j.jsx)("input",{type:"checkbox",disabled:!0})}),Object(j.jsx)("div",{className:"todo-item-input",children:Object(j.jsx)("input",{type:"text",placeholder:"Add todo item ...",value:s.title,onChange:function(e){return i((function(t){return Object(h.a)(Object(h.a)({},t),{},{title:e.target.value})}))},onKeyUp:function(e){"Enter"===e.key&&(a.db.todoItems.add({todoListId:t.id,realmId:t.realmId,title:s.title}),i({todoListId:t.id,title:""}))}})})]})}var x=n(9),p=n.n(x),v=n(14),O=n(28),f={owner:u.i,doer:u.a,manager:u.j,readonly:u.c};function w(e){var t=e.todoList,n=e.member,r=e.access,c=Object(o.useObservable)(a.db.cloud.roles)||{};return Object(j.jsxs)("select",{disabled:t.owner===n.userId&&n.userId===a.db.cloud.currentUserId,style:{border:0},value:r,onChange:function(e){return function(e,t,n,r){var c=Object(O.b)(e.id);return a.db.transaction("rw",a.db.todoLists,a.db.members,a.db.realms,(function(){if("owner"!==n&&"owner"===r){if(!t.userId)throw new Error("Cannot give ownership to user before invite is accepted.");a.db.members.where({realmId:c,userId:e.owner}).modify({roles:["manager"]}),a.db.todoLists.update(e,{owner:t.userId}),a.db.realms.update(c,{owner:t.userId})}"owner"!==r&&a.db.members.update(t,{permissions:{},roles:[r]}),"owner"===n&&"owner"!==r&&(a.db.todoLists.update(e,{owner:a.db.cloud.currentUserId}),a.db.realms.update(c,{owner:a.db.cloud.currentUserId}))}))}(t,n,r,e.target.value)},children:[Object(j.jsx)("option",{value:"owner",disabled:!n.userId,children:"Owner"}),Object.entries(c).map((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(j.jsx)("option",{value:n,children:r.displayName},n)})),!c[r]&&"owner"!==r&&Object(j.jsx)("option",{children:"(unknown)"},r)]})}function g(e){var t,n=e.member,r=e.todoList,c=Object(o.usePermissions)(a.db,"members",n),s=Object(o.useObservable)(a.db.cloud.roles),i=null===(t=n.roles)||void 0===t?void 0:t[0],d=i?null===s||void 0===s?void 0:s[i]:null,b=n.userId===r.owner?"owner":i||"readonly",h="owner"===b?"Owner":(null===d||void 0===d?void 0:d.displayName)||b;return Object(j.jsxs)("fieldset",{className:"border p-1",children:[Object(j.jsx)(l.a,{style:{margin:"0 4px 0 0",width:22},icon:f[b]||u.e}),c.update("roles")?Object(j.jsx)(w,{todoList:r,member:n,access:b}):h]})}var y=n(69);function I(e){var t=e.todoList,n=Object(r.useState)(""),c=Object(d.a)(n,2),s=c[0],i=c[1],l=Object(r.useState)(""),u=Object(d.a)(l,2),b=u[0],h=u[1],m=Object(o.useLiveQuery)(Object(v.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.members.where({realmId:t.realmId}).toArray();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),[t.realmId]),x=Object(r.useState)(!1),O=Object(d.a)(x,2),f=O[0],w=O[1],g=Object(o.usePermissions)(t);return Object(j.jsxs)(j.Fragment,{children:[m&&m.length>0&&Object(j.jsxs)("table",{children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Shared with:"}),Object(j.jsx)("th",{children:"Role"})]})}),Object(j.jsx)("tbody",{children:null===m||void 0===m?void 0:m.map((function(e){return Object(j.jsx)(k,{todoList:t,member:e},e.id)}))})]}),Object(j.jsx)("hr",{}),g.add("members")&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h4",{children:"Invite someone?"}),Object(j.jsx)("table",{children:Object(j.jsx)("tbody",{children:Object.keys(y.demoUsers).filter((function(e){return e!==a.db.cloud.currentUserId})).map((function(e){return Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:e}),Object(j.jsx)("td",{children:Object(j.jsx)("button",{type:"button",onClick:function(){w(!1),t.shareWith(e,e,!0,["doer"])},children:"Invite"})})]},e)}))})}),f?Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),w(!1),t.shareWith(s,b,!0,["doer"])},children:[Object(j.jsx)("input",{type:"email",placeholder:"Email",value:b,onChange:function(e){return h(e.target.value)}}),Object(j.jsx)("input",{type:"text",placeholder:"Name",value:s,onChange:function(e){return i(e.target.value)}}),Object(j.jsx)("button",{type:"submit",disabled:!/@/.test(b),children:"Send invite"})]}):Object(j.jsx)("a",{href:"#",onClick:function(e){e.preventDefault(),w(!0)},children:"Invite by email address"}),Object(j.jsx)("hr",{})]})]})}function k(e){var t,n,r=e.member,c=e.todoList,s=Object(o.usePermissions)(a.db,"members",r),i=r.userId===a.db.cloud.currentUserId,d=r.userId===c.owner,b=r.name||r.email||r.userId;return i&&(b+=" (me)"),Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{style:{paddingRight:12},children:b}),Object(j.jsx)("td",{children:Object(j.jsx)(g,{member:r,todoList:c})}),Object(j.jsx)("td",{children:s.delete()&&!d?Object(j.jsx)("div",{className:"todo-list-trash",children:Object(j.jsx)("button",{className:"button",onClick:function(){return c.unshareWith(r)},children:Object(j.jsx)(l.a,{icon:u.g})})}):!d&&r.userId===a.db.cloud.currentUserId&&(((null===(t=r.accepted)||void 0===t?void 0:t.getTime())||0)>((null===(n=r.rejected)||void 0===n?void 0:n.getTime())||0)?Object(j.jsx)("button",{onClick:function(){return c.leave()},children:"Leave list"}):Object(j.jsx)("button",{onClick:function(){return a.db.members.update(r.id,{accepted:new Date,rejected:void 0})},children:"Accept invite"}))}),Object(j.jsx)("td",{})]})}function L(e){var t=e.todoList,n=Object(o.useLiveQuery)((function(){return a.db.todoItems.where({todoListId:t.id}).toArray()}),[t.id]),r=Object(o.usePermissions)(t),c=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return[null!==(n=Object(o.useLiveQuery)((function(){return a.db.openCloseStates.get([e,t])}),[e,t],r))&&void 0!==n?n:r,function(n){return a.db.openCloseStates.put(n,[e,t])}]}("sharing-menu",t.id,!1),s=Object(d.a)(c,2),i=s[0],h=s[1];return n?Object(j.jsxs)("div",{className:"box",children:[Object(j.jsxs)("div",{className:"grid-row",children:[Object(j.jsx)("h2",{children:t.title}),Object(j.jsx)("div",{className:"todo-list-trash",children:Object(j.jsx)("button",{disabled:!r.delete(),onClick:function(){return t.delete()},title:"Delete list",children:Object(j.jsx)(l.a,{icon:u.h})})}),!t.isPrivate()&&Object(j.jsx)("div",{className:"todo-list-trash",children:Object(j.jsx)("button",{onClick:function(){return h(!i)},children:Object(j.jsx)(l.a,{icon:u.f})})})]}),i&&Object(j.jsx)(I,{todoList:t}),Object(j.jsx)("div",{children:n.map((function(e){return Object(j.jsx)(b,{item:e},e.id)}))}),Object(j.jsx)("div",{children:r.add("todoItems")&&Object(j.jsx)(m,{todoList:t})})]}):null}function C(){var e=Object(o.useLiveQuery)((function(){return a.db.todoLists.toArray()}));return e?Object(j.jsx)("div",{children:e.map((function(e){return Object(j.jsx)(L,{todoList:e},e.id)}))}):null}function N(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(""),i=Object(d.a)(s,2),b=i[0],h=i[1],m=Object(o.useLiveQuery)(Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.todoLists.count();case 2:return t=e.sent,e.abrupt("return",t>0);case 4:case"end":return e.stop()}}),e)}))));return n?Object(j.jsxs)("div",{className:"box",children:[Object(j.jsx)("h2",{children:"Give your list a name:"}),Object(j.jsx)("div",{className:"todo-item-input",children:Object(j.jsx)("input",{type:"text",autoFocus:!0,placeholder:"Name of list...",value:b,onChange:function(e){return h(e.target.value)},onKeyUp:function(e){"Enter"===e.key&&(a.db.todoLists.add({title:b}),h(""),c(!1))}})})]}):Object(j.jsxs)("button",{className:"large-button",onClick:function(){return c(!n)},children:[Object(j.jsx)(l.a,{icon:u.d})," ",m?"Add another list":"Create ToDo List"]})}function S(){return Object(j.jsxs)("button",{className:"large-button",onClick:Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.db.delete();case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)}))),children:[Object(j.jsx)(l.a,{icon:u.b})," Factory reset client"]})}var U=n(121),M=n(120),z=n(86),A=n(85),D=n(122),W=function(){return Object(j.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 125",xmlSpace:"preserve",children:[Object(j.jsx)("g",{children:Object(j.jsx)("path",{d:"M81.2,38.9c-3.5-12.9-15.3-22-28.9-22c-11.4,0-21.9,6.7-26.9,16.8C12.6,34.6,2.5,45.3,2.5,58.4     c0,13.6,11.1,24.7,24.7,24.7h47.7c12.4,0,22.6-10.1,22.6-22.6C97.5,50.3,90.8,41.6,81.2,38.9z M74.9,75.4H27.2     c-9.4,0-17-7.6-17-17s7.6-17,17-17c0.2,0,0.4,0,0.6,0c1.6,0,3.2-0.9,3.7-2.5c3.3-8.5,11.6-14.3,20.8-14.3     c10.7,0,19.9,7.6,21.9,18.1c0.3,1.6,1.6,2.9,3.2,3.1c7.2,1.2,12.4,7.3,12.4,14.6C89.8,68.7,83.1,75.4,74.9,75.4z"})}),Object(j.jsxs)("g",{transform:"translate(14,-958.36218)",children:[Object(j.jsx)("path",{id:"third",d:"m 35,1000.3621 c -8.058,0 -15.4484,2.7386 -21.2188,7.1875 a 2.0002,2.0002 0 1 0 2.4376,3.1562 c 5.0947,-3.9281 11.635,-6.3437 18.7812,-6.3437 7.1462,0 13.6865,2.4156 18.7812,6.3437 a 2.0002,2.0002 0 1 0 2.4376,-3.1562 C 50.4484,1003.1007 43.058,1000.3621 35,1000.3621"}),Object(j.jsx)("path",{id:"second",d:"m 35,1009.3621 c -5.8189,0 -11.3007,1.7801 -15.5625,5.2812 a 2.0002,2.0002 0 1 0 2.5313,3.0938 c 3.4852,-2.8633 8.0339,-4.375 13.0312,-4.375 4.9973,0 9.546,1.5117 13.0312,4.375 a 2.0002,2.0002 0 1 0 2.5313,-3.0938 c -4.2618,-3.5011 -9.7436,-5.2812 -15.5625,-5.2812"}),Object(j.jsx)("path",{opacity:"0.4",id:"first",d:"m 35,1018.9376 c -3.6493,0 -7.1142,1.1668 -9.8125,3.3437 a 2.0009763,2.0009763 0 0 0 2.5,3.125 c 1.9329,-1.5594 4.5256,-2.4687 7.3125,-2.4687 2.7869,0 5.3796,0.9093 7.3125,2.4687 a 2.0009763,2.0009763 0 1 0 2.5,-3.125 c -2.6983,-2.1769 -6.1632,-3.3437 -9.8125,-3.3437 z m 0,8.0625 z"})]}),Object(j.jsx)("animate",{xlinkHref:"#first",attributeName:"opacity",dur:"3s",begin:"0s",calcMode:"discrete",from:"0.2",to:"1",repeatDur:"indefinite"}),Object(j.jsx)("animate",{xlinkHref:"#second",attributeName:"opacity",dur:"3s",begin:"0.7s",calcMode:"discrete",from:"0.2",to:"1",repeatDur:"indefinite"}),Object(j.jsx)("animate",{xlinkHref:"#third",attributeName:"opacity",dur:"3s",begin:"1.4s",calcMode:"discrete",from:"0.2",to:"1",repeatDur:"indefinite"})]})},P=function(){return Object(j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlSpace:"preserve",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"optimizeQuality"},viewBox:"0 0 755 633.75",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",children:Object(j.jsx)("g",{children:Object(j.jsx)("path",{d:"M205 111c69,-162 315,-141 357,29 47,9 88,40 108,84 139,63 99,283 -63,283l-459 0c-155,0 -201,-204 -76,-276 14,-64 68,-112 133,-120zm41 287c-15,16 -40,-8 -24,-24 38,-39 102,-54 155,-54 53,0 118,15 156,54 15,16 -9,40 -24,24 -32,-32 -88,-44 -132,-44 -43,0 -100,12 -131,44zm235 -190c-18,0 -33,15 -33,33 0,17 15,32 33,32 17,0 32,-15 32,-32 0,-18 -15,-33 -32,-33zm-207 0c18,0 33,15 33,33 0,17 -15,32 -33,32 -18,0 -32,-15 -32,-32 0,-18 14,-33 32,-33zm364 49c116,36 90,207 -31,207l-459 0c-117,0 -148,-163 -37,-204 3,-60 52,-108 113,-108 4,0 8,0 11,0 41,-161 280,-140 290,27 2,0 5,0 8,0 49,0 91,33 105,78z"})})})},T=function(){return Object(j.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg","data-name":"Layer 1",viewBox:"0 0 100 125",x:"0px",y:"0px",children:[Object(j.jsx)("path",{d:"M88.17,69.32A22,22,0,0,0,77.79,37.77a22,22,0,0,0-21.91-20.2,20.29,20.29,0,0,0-13.67,4.81l4.57,5.3a13.31,13.31,0,0,1,9.1-3.11,15,15,0,0,1,15,15c0,.06,0,.13,0,.19s0,.26,0,.39l-.1,2.75,2.65.75a15,15,0,0,1,8.79,22.1Z"}),Object(j.jsx)("path",{d:"M28.76,80H60.44V73H28.76a15,15,0,0,1-15-15A17,17,0,0,1,23.6,42.7l-2.79-6.42A23.91,23.91,0,0,0,6.78,58,22,22,0,0,0,28.76,80Z"}),Object(j.jsx)("rect",{x:"45.53",y:"-4.58",width:"7",height:"106.75",transform:"translate(-20.14 48.96) rotate(-45)"})]})},E=function(){return Object(j.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 125",xmlSpace:"preserve",children:Object(j.jsxs)("g",{children:[Object(j.jsx)("path",{d:"M81.2,38.9c-3.5-12.9-15.3-22-28.9-22c-11.4,0-21.9,6.7-26.9,16.8C12.6,34.6,2.5,45.3,2.5,58.4     c0,13.6,11.1,24.7,24.7,24.7h47.7c12.4,0,22.6-10.1,22.6-22.6C97.5,50.3,90.8,41.6,81.2,38.9z M74.9,75.4H27.2     c-9.4,0-17-7.6-17-17s7.6-17,17-17c0.2,0,0.4,0,0.6,0c1.6,0,3.2-0.9,3.7-2.5c3.3-8.5,11.6-14.3,20.8-14.3     c10.7,0,19.9,7.6,21.9,18.1c0.3,1.6,1.6,2.9,3.2,3.1c7.2,1.2,12.4,7.3,12.4,14.6C89.8,68.7,83.1,75.4,74.9,75.4z"}),Object(j.jsx)("path",{d:"M60.8,39.5c-0.8-0.6-1.9-0.5-2.6,0.2L43.4,56.5l-4.5-5.2c-0.7-0.8-1.8-0.9-2.6-0.2l-3.2,2.6c-0.8,0.6-0.9,1.8-0.3,2.6     l6.6,8.9c0.4,0.5,0.9,0.7,1.5,0.8l4.9,0c0.6,0,1.2-0.3,1.5-0.8l15.9-21.3c0.6-0.8,0.5-1.9-0.3-2.6L60.8,39.5z"})]})})},B=function(){return Object(j.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 125",xmlSpace:"preserve",children:[Object(j.jsx)("g",{transform:"scale(1 0.95) translate(0 10)",children:Object(j.jsx)("path",{d:"M81.2,38.9c-3.5-12.9-15.3-22-28.9-22c-11.4,0-21.9,6.7-26.9,16.8C12.6,34.6,2.5,45.3,2.5,58.4     c0,13.6,11.1,24.7,24.7,24.7h47.7c12.4,0,22.6-10.1,22.6-22.6C97.5,50.3,90.8,41.6,81.2,38.9z M74.9,75.4H27.2     c-9.4,0-17-7.6-17-17s7.6-17,17-17c0.2,0,0.4,0,0.6,0c1.6,0,3.2-0.9,3.7-2.5c3.3-8.5,11.6-14.3,20.8-14.3     c10.7,0,19.9,7.6,21.9,18.1c0.3,1.6,1.6,2.9,3.2,3.1c7.2,1.2,12.4,7.3,12.4,14.6C89.8,68.7,83.1,75.4,74.9,75.4z"})}),Object(j.jsxs)("g",{transform:"translate(-40,-20) scale(1.5 1.5)",children:[Object(j.jsx)("polygon",{points:"84.453,20.676 87.936,20.687 84.442,23.66 84.433,25.766 91.565,25.793 91.572,23.755   88.007,23.741 91.58,20.701 91.591,18.665 84.458,18.636 "}),Object(j.jsx)("polygon",{points:"82.076,21.047 72.533,21.011 72.525,23.739 77.184,23.755 72.507,27.732 72.5,30.552 82.042,30.589   82.051,27.861 77.281,27.842 82.065,23.774 "})]}),Object(j.jsxs)("g",{transform:"translate(-29 -10) scale(1.5 1.5)",children:[Object(j.jsx)("path",{d:"M42.5,49.062h-3.75c-0.518,0-0.938,0.419-0.938,0.938s0.419,0.938,0.938,0.938h3.75  c0.518,0,0.938-0.419,0.938-0.938S43.018,49.062,42.5,49.062z"}),Object(j.jsx)("path",{d:"M61.25,49.062H57.5c-0.518,0-0.938,0.419-0.938,0.938s0.419,0.938,0.938,0.938h3.75  c0.518,0,0.938-0.419,0.938-0.938S61.768,49.062,61.25,49.062z"})]})]})};n(104);function F(e){var t=e.children,n=e.className,r=e.title;return Object(j.jsx)("div",{className:"svg-icon"+(n?" "+n:""),title:r,children:Object(j.jsx)("div",{children:t})})}function H(e){var t=e.className,n=Object(D.a)(a.db.cloud.syncState);switch(null===n||void 0===n?void 0:n.status){case"not-started":return Object(j.jsx)(F,{className:t});case"connecting":return Object(j.jsx)(F,{className:t,children:Object(j.jsx)(W,{})});case"connected":return Object(j.jsx)(F,{className:t,children:Object(j.jsx)(E,{})});case"disconnected":return Object(j.jsx)(F,{className:t,children:Object(j.jsx)(B,{})});case"offline":return Object(j.jsx)(F,{className:t,title:n.error&&""+n.error,children:Object(j.jsx)(T,{})});case"error":return Object(j.jsx)(F,{className:t,title:n.error&&""+n.error,children:Object(j.jsx)(P,{})});default:return Object(j.jsx)(F,{className:t,children:null===n||void 0===n?void 0:n.phase})}}n(105);function R(e){return function(){return e.apply(void 0,arguments).catch((function(e){"AbortError"===(null===e||void 0===e?void 0:e.name)?console.debug(e):console.error(e)}))}}var Q=n(51);function X(){return(X=Object(v.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.a.delete();case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){var e=Object(D.a)(a.db.cloud.currentUser);return Object(j.jsxs)(U.a,{fixed:"top",sticky:"top",collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(j.jsx)(U.a.Brand,{children:"Dexie Cloud ToDo App"}),Object(j.jsx)(U.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(j.jsx)(U.a.Text,{className:"d-inline-flex d-lg-none status-icons-collapsed",children:Object(j.jsx)(H,{})}),Object(j.jsx)(U.a.Collapse,{id:"responsive-navbar-nav",className:"justify-content-end",children:(null===e||void 0===e?void 0:e.isLoggedIn)?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(U.a.Text,{className:"d-none d-lg-inline-flex status-icons-not-collapsed",children:Object(j.jsx)(H,{})}),Object(j.jsx)(M.a,{title:e.name,id:"basic-nav-dropdown",children:Object(j.jsx)(M.a.Item,{onClick:function(){return function(){return X.apply(this,arguments)}()},children:"Logout"})})]}):Object(j.jsxs)(M.a,{id:"basic-nav-dropdown",title:"Sign in or create your account",children:[Object(j.jsx)(M.a.Header,{children:"Sign in a demo user"}),Object(j.jsx)(j.Fragment,{children:Object.keys(y.demoUsers).map((function(e){return Object(j.jsx)(M.a.Item,{children:Object(j.jsx)(z.a,{onClick:R((function(){return a.db.cloud.login({grant_type:"demo",email:e})})),children:e})},e)}))}),Object(j.jsx)(M.a.Divider,{}),Object(j.jsx)(M.a.Header,{children:"Sign in real user"}),Object(j.jsx)(M.a.Item,{children:Object(j.jsx)(A.a,{onClick:R((function(){return a.db.cloud.login()})),children:"Sign in / sign up yourself"})})]})})]})}n(107),n(108);function q(){var e=Object(D.a)(a.db.cloud.currentUser),t=Object(D.a)(a.db.cloud.invites,[]);return 0===t.length?null:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h3",{children:"You've got invited!"}),Object(j.jsxs)("table",{children:[Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{}),Object(j.jsx)("th",{children:"Name of list"}),Object(j.jsx)("th",{children:"Invited by"})]}),t.map((function(t){var n,r;return Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{children:t.accepted?"\u2713":t.email===(null===e||void 0===e?void 0:e.email)?Object(j.jsx)("button",{onClick:function(){return a.db.members.update(t.id,{accepted:new Date})},children:"Accept"}):""}),Object(j.jsx)("td",{children:null===(n=t.realm)||void 0===n?void 0:n.name}),Object(j.jsx)("td",{children:null===(r=t.invitedBy)||void 0===r?void 0:r.name})]},t.id)}))]})]})}var K=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(J,{}),Object(j.jsx)(q,{}),Object(j.jsx)(C,{}),Object(j.jsx)(N,{}),Object(j.jsx)(S,{})]})},Z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function G(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,123)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),s(e),i(e)}))},Y=n(8);window.Dexie=Y.default,i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(K,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");Z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):G(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):G(t,e)}))}}(),V()},4:function(e,t,n){"use strict";var r=n(51);n.d(t,"db",(function(){return r.a}));n(54),n(81),n(52)},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=new(n(54).a)},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(9),c=n.n(r),s=n(14),i=n(55),o=n(82),a=n(74),d=n(73),l=n(8),u=n(28),j=function(e){Object(a.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).id=void 0,e.realmId=void 0,e.owner=void 0,e.title=void 0,e}return Object(o.a)(n,[{key:"isSharable",value:function(){return this.realmId===Object(u.b)(this.id)}},{key:"isPrivate",value:function(){return"#"===this.id[0]}},{key:"makeSharable",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r,i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPrivate()){e.next=2;break}throw new Error("Private lists cannot be made sharable");case 2:return t=this.realmId,n=Object(u.b)(this.id),r=this.db,e.next=7,this.db.transaction("rw",[r.todoLists,r.todoItems,r.realms],Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.realms.put({realmId:n,name:i.title,represents:"a to-do list"});case 2:return e.next=4,r.todoLists.update(i.id,{realmId:n});case 4:return e.next=6,r.todoItems.where({realmId:t,todoListId:i.id}).modify({realmId:n});case 6:case"end":return e.stop()}}),e)}))));case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unshareWithEveryone",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.db,n=Object(u.b)(this.id),e.next=4,t.transaction("rw",[t.todoLists,t.todoItems,t.members,t.realms],Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.todoItems.where({realmId:n,todoListId:r.id}).modify({realmId:t.cloud.currentUserId});case 2:return e.next=4,t.todoLists.update(r.id,{realmId:r.db.cloud.currentUserId});case 4:return e.next=6,t.members.where("realmId").equals(n).delete();case 6:return e.next=8,t.realms.delete(n);case 8:case"end":return e.stop()}}),e)}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shareWith",value:function(){var e=Object(s.a)(c.a.mark((function e(t,n,r,i){var o,a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.db,e.next=3,o.transaction("rw",[o.members,o.todoLists,o.todoItems,o.realms],Object(s.a)(c.a.mark((function e(){var s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=a.realmId,a.isSharable()){e.next=5;break}return e.next=4,a.makeSharable();case 4:s=e.sent;case 5:return e.next=7,a.db.members.add({realmId:s,name:t,email:n,invite:r,roles:i});case 7:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,c){return e.apply(this,arguments)}}()},{key:"unshareWith",value:function(){var e=Object(s.a)(c.a.mark((function e(t){var n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.db,e.next=3,n.transaction("rw",[n.todoLists,n.todoItems,n.members,n.realms],Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.members.delete(t.id);case 2:return e.next=4,n.members.where({realmId:r.realmId}).filter((function(e){return e.userId!==n.cloud.currentUserId})).count();case 4:if(0!==e.sent){e.next=8;break}return e.next=8,r.unshareWithEveryone();case 8:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"leave",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.db,e.next=3,t.members.where({realmId:this.realmId,userId:t.cloud.currentUserId}).delete();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(s.a)(c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.db,e.next=3,t.transaction("rw",[t.todoLists,t.todoItems,t.members,t.realms],(function(){t.todoItems.where({todoListId:n.id}).delete(),t.todoLists.delete(n.id);var e=Object(u.b)(n.id);t.members.where({realmId:e}).delete(),t.realms.delete(e)}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(l.Entity)},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(55),c=n(56),s=n(74),i=n(73),o=n(8),a=n(28);var d=n(52),l=function(e){Object(s.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this,"TodoDBCloud2",{addons:[a.a]})).todoLists=void 0,e.todoItems=void 0,e.openCloseStates=void 0,e.version(14).stores({todoLists:"@id",todoItems:"@id, [todoListId+realmId]",openCloseStates:""}),e.todoLists.mapToClass(d.a),e.on("populate",(function(){e.on("ready",(function(){Object(c.a)(e)}))})),e.cloud.configure({unsyncedTables:["openCloseStates"],databaseUrl:"https://z0lesejpr.dexie.cloud",tryUseServiceWorker:!0,requireAuth:!1}),e}return n}(o.default)},69:function(e){e.exports=JSON.parse('{"demoUsers":{"alice@demo.local":{},"bob@demo.local":{},"foo@demo.local":{},"bar@demo.local":{}},"roles":{"manager":{"displayName":"Manager","description":"Members with this role gains full permissions within the realm pointed out by the member entry","sortOrder":1,"permissions":{"manage":"*"}},"doer":{"displayName":"Doer","description":"Members with this role can add todoItems, manage own todoItems and mark other todoItems as done or undone","sortOrder":2,"permissions":{"add":["todoItems"],"update":{"todoItems":["done"]}}},"readonly":{"displayName":"ReadOnly","description":"Members with this role have no permissions to change any data","sortOrder":3,"permissions":{}}},"data":{}}')},81:function(e,t){},92:function(e,t,n){}},[[109,1,2]]]);
//# sourceMappingURL=main.1abdad06.chunk.js.map